{"ast":null,"code":"var _jsxFileName = \"/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/src/pages/FeedPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { CardFeedPage } from '../components/CardFeedPage';\nimport Stack from 'react-bootstrap/Stack';\nimport { NavLink } from \"react-router-dom\";\nimport { useSelector, useDispatch } from 'react-redux';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport { selectCurrentUser } from './UserPage/currentUserSlice';\nimport { getUsersAsList, getLastestPostOfAUser, getPost, getUser, getUserFollowingSuggestion, getTotalFollowingPosts } from \"../fetcher\";\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst delay = ms => new Promise(res => setTimeout(res, ms));\nexport default function FeedPage() {\n  _s();\n  const dispatch = useDispatch();\n  // get followings of the current user\n  const stateCurrentUser = useSelector(selectCurrentUser);\n  let followingsUsernames = stateCurrentUser.followings;\n  const [feedPostOfUser, setFeedPostOfUser] = useState([]);\n  const [popularPostsNearby, setPopularPostsNearby] = useState([]);\n  const [editedAndRefreshCards, setEditedAndRefreshCards] = useState(true); //the value of this switch doesn't matter only the change matter for triggering useEffect\n  const [hearFromDeleteComment, setHearFromDeleteComment] = useState(false); //the request for refreshing comment list from PopUp window, trigger value doesnt matter\n  const [visibility, setVisibility] = useState(false);\n  const [postBeingEdited, setPostBeingEdited] = useState({});\n  const [suggestions, setSuggestions] = useState([]);\n  const [numPosts, setnumPosts] = useState(0);\n  useEffect(() => {\n    getUserFollowingSuggestion(stateCurrentUser.username).then(value => {\n      setSuggestions(value);\n      console.log(suggestions);\n    });\n  }, []);\n  useEffect(() => {\n    async function fetchData() {\n      const userObjects = await getUsersAsList(followingsUsernames);\n\n      //remove user who has no post\n      const userObjectsFiltered = userObjects.filter(object => {\n        return object.posts.length !== 0;\n      });\n\n      // map the object to it's latest post\n      const followingsLatestPost = await Promise.all(userObjectsFiltered.map(async o => {\n        //return the largest(most recent) ID\n        let postObject = await getLastestPostOfAUser(o.username);\n        return postObject;\n      }));\n      setFeedPostOfUser(followingsLatestPost);\n      const numPost = await getTotalFollowingPosts(followingsUsernames);\n      setnumPosts(numPost);\n      // fetch popular post\n      // get the popular post\n    }\n\n    try {\n      fetchData();\n      delay(5000);\n      console.log(numPosts);\n    } catch (err) {\n      console.error(err);\n    }\n  }, [editedAndRefreshCards, hearFromDeleteComment, numPosts]); //adding empty dependency making sure useEffect only run once after each render\n\n  const cards = (feedPostOfUser.length === 0 ? popularPostsNearby : feedPostOfUser).map(p => /*#__PURE__*/_jsxDEV(CardFeedPage, {\n    post: p,\n    username: stateCurrentUser.username,\n    oldEditedAndRefreshCards: editedAndRefreshCards,\n    allDisplayedPosts: feedPostOfUser,\n    setEditedAndRefreshCards: setEditedAndRefreshCards,\n    setCommentState: setFeedPostOfUser,\n    setPostBeingEdited: setPostBeingEdited,\n    setVisibility: setVisibility\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this));\n  let userlist = suggestions.map(p => /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n    as: \"li\",\n    children: /*#__PURE__*/_jsxDEV(NavLink, {\n      to: \"/user/\" + p,\n      className: \"button_text\",\n      children: p\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 5\n  }, this));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"background\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        style: {\n          paddingLeft: \"10%\"\n        },\n        children: [stateCurrentUser.username === \"NOT_A_USER\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: \"Please log in to see the activity feed.\"\n        }, void 0, false), /*#__PURE__*/_jsxDEV(Stack, {\n          gap: 2,\n          className: \"col-md-6 mx-auto\",\n          children: cards\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        style: {\n          paddingLeft: \"20%\",\n          paddingRight: \"10%\",\n          paddingBottom: \"2rem\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            paddingBottom: \"2rem\"\n          },\n          children: \" Recommended Users to Follow \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n          as: \"ul\",\n          defaultActiveKey: \"#link1\",\n          children: userlist\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n}\n_s(FeedPage, \"6rlPA3vdrJOBQfy34LCzfb9ysU8=\", false, function () {\n  return [useDispatch, useSelector];\n});\n_c = FeedPage;\nvar _c;\n$RefreshReg$(_c, \"FeedPage\");","map":{"version":3,"names":["React","useState","useEffect","CardFeedPage","Stack","NavLink","useSelector","useDispatch","ListGroup","selectCurrentUser","getUsersAsList","getLastestPostOfAUser","getPost","getUser","getUserFollowingSuggestion","getTotalFollowingPosts","Row","Col","delay","ms","Promise","res","setTimeout","FeedPage","dispatch","stateCurrentUser","followingsUsernames","followings","feedPostOfUser","setFeedPostOfUser","popularPostsNearby","setPopularPostsNearby","editedAndRefreshCards","setEditedAndRefreshCards","hearFromDeleteComment","setHearFromDeleteComment","visibility","setVisibility","postBeingEdited","setPostBeingEdited","suggestions","setSuggestions","numPosts","setnumPosts","username","then","value","console","log","fetchData","userObjects","userObjectsFiltered","filter","object","posts","length","followingsLatestPost","all","map","o","postObject","numPost","err","error","cards","p","userlist","paddingLeft","paddingRight","paddingBottom"],"sources":["/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/src/pages/FeedPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { CardFeedPage } from '../components/CardFeedPage';\nimport Stack from 'react-bootstrap/Stack';\nimport { NavLink } from \"react-router-dom\";\nimport { useSelector, useDispatch } from 'react-redux'\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport { selectCurrentUser } from './UserPage/currentUserSlice'\nimport { getUsersAsList, getLastestPostOfAUser, getPost, getUser, getUserFollowingSuggestion, getTotalFollowingPosts } from \"../fetcher\";\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\nconst delay = ms => new Promise(res => setTimeout(res, ms));\n\nexport default function FeedPage() {\n  const dispatch = useDispatch();\n  // get followings of the current user\n  const stateCurrentUser = useSelector(selectCurrentUser);\n  let followingsUsernames = stateCurrentUser.followings;\n  const [feedPostOfUser, setFeedPostOfUser] = useState([]);\n  const [popularPostsNearby, setPopularPostsNearby] = useState([]);\n  const [editedAndRefreshCards, setEditedAndRefreshCards] = useState(true); //the value of this switch doesn't matter only the change matter for triggering useEffect\n  const [hearFromDeleteComment, setHearFromDeleteComment] = useState(false); //the request for refreshing comment list from PopUp window, trigger value doesnt matter\n  const [visibility, setVisibility] = useState(false);\n  const [postBeingEdited, setPostBeingEdited] = useState({});\n  const [suggestions, setSuggestions] = useState([]);\n  const [numPosts, setnumPosts] = useState(0);\n\n  useEffect(() => {\n    getUserFollowingSuggestion(stateCurrentUser.username).then(\n      value => {\n        setSuggestions(value);\n        console.log(suggestions)\n      });\n  }, []);\n\n  useEffect(() => {\n    async function fetchData() {\n      const userObjects = await getUsersAsList(followingsUsernames);\n\n      //remove user who has no post\n      const userObjectsFiltered = userObjects.filter((object) => {\n        return object.posts.length !== 0;\n      });\n\n      // map the object to it's latest post\n      const followingsLatestPost = await Promise.all(userObjectsFiltered.map(async (o) => {\n        //return the largest(most recent) ID\n        let postObject = await getLastestPostOfAUser(o.username);\n        return postObject;\n      }))\n      \n      setFeedPostOfUser(followingsLatestPost);\n      const numPost = await getTotalFollowingPosts(followingsUsernames);\n      setnumPosts(numPost);\n      // fetch popular post\n      // get the popular post\n    }\n    try {\n      fetchData();\n      delay(5000);\n      console.log(numPosts);\n    }\n    catch (err) {\n      console.error(err);\n    }\n  }, [editedAndRefreshCards, hearFromDeleteComment, numPosts]); //adding empty dependency making sure useEffect only run once after each render\n\n\n  const cards = ((feedPostOfUser.length === 0) ? popularPostsNearby : feedPostOfUser).map((p) => (\n    <CardFeedPage post={p} username={stateCurrentUser.username} oldEditedAndRefreshCards={editedAndRefreshCards} allDisplayedPosts={feedPostOfUser}\n      setEditedAndRefreshCards={setEditedAndRefreshCards} setCommentState={setFeedPostOfUser}\n      setPostBeingEdited={setPostBeingEdited} setVisibility={setVisibility} />\n  ))\n\n  let userlist = suggestions.map((p) => (\n    <ListGroup.Item as=\"li\" >\n      <NavLink to={\"/user/\" + p} className=\"button_text\">\n        {p}\n      </NavLink>\n    </ListGroup.Item>\n  ))\n\n  return (\n    <div className='background'>\n\n      <Row>\n        <Col style={{ paddingLeft: \"10%\" }}>\n          {stateCurrentUser.username === \"NOT_A_USER\" && <>Please log in to see the activity feed.</>}\n          <Stack gap={2} className=\"col-md-6 mx-auto\">\n            {cards}\n          </Stack>\n        </Col>\n\n        <Col style={{ paddingLeft: \"20%\", paddingRight: \"10%\", paddingBottom: \"2rem\" }}>\n          <h4 style={{ paddingBottom: \"2rem\" }}> Recommended Users to Follow </h4>\n          <ListGroup as=\"ul\" defaultActiveKey=\"#link1\">\n            {userlist}\n          </ListGroup>\n        </Col>\n\n      </Row>\n\n    </div>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}