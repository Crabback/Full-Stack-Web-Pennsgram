{"ast":null,"code":"import _regeneratorRuntime from\"/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"../Styles.css\";import React,{useState}from'react';import{addComment,deletePost,deleteComment,updateComment}from\"../fetcher\";import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Modal from'react-bootstrap/Modal';import Stack from'react-bootstrap/Stack';import{NavLink}from\"react-router-dom\";import Form from'react-bootstrap/Form';import Button from'react-bootstrap/Button';import{MentionsInput,Mention}from'react-mentions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export function MyCommentsModal(props){var comments=props.post.comments;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editShow=_useState2[0],setEditShow=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),editInput=_useState4[0],setEditInput=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),beingEdit=_useState6[0],setBeingEdit=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),mentionInput=_useState8[0],setMentionInput=_useState8[1];function handleUpdateComment(_x,_x2,_x3,_x4,_x5,_x6){return _handleUpdateComment.apply(this,arguments);}function _handleUpdateComment(){_handleUpdateComment=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e,postId,author,oldComment,newComment,mention){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return updateComment(postId,author,oldComment,newComment,mention);case 4:// tell my grandparent to refresh the page \nprops.setEditedAndRefreshCards(!props.oldEditedAndRefreshCards);alert(\"update comment successful!\");//setEditedAndRefreshCards to trigger rerender and data fetching\nprops.setEditedAndRefreshCards(!props.oldEditedAndRefreshCards);//setShow(false);\nsetEditShow(function(current){return!current;});props.onHide();_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.log(\"update comment failed.\");alert(\"update comment failed.\");case 15:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return _handleUpdateComment.apply(this,arguments);};function handleDeleteComment(_x7,_x8,_x9){return _handleDeleteComment.apply(this,arguments);}function _handleDeleteComment(){_handleDeleteComment=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(postId,author,content){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;console.log(\"'\".concat(postId,\"', '\").concat(author,\"', '\").concat(content,\"'\"));_context2.next=4;return deleteComment(postId,author,content);case 4:res=_context2.sent;console.log(\"response: \",res);// tell my grandparent to refresh the page \nprops.setEditedAndRefreshCards(!props.oldEditedAndRefreshCards);alert(\"Delete comment successful!\");_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(\"Delete comment failed.\");alert(\"Delete comment failed.\");case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return _handleDeleteComment.apply(this,arguments);};var commentsList=comments.length===0?[]:comments.map(function(c){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-light border\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"h4\",{children:c.author})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"p\",{children:[c.comment+\" \",/*#__PURE__*/_jsx(NavLink,{to:\"/user/\"+c.mention.replace(')','').split(\"(\")[1],className:\"button_text\",children:c.mention.split(\"(\")[0]}),c.author===props.username&&/*#__PURE__*/_jsx(Button,{onClick:function onClick(e){setEditShow(function(current){return!current;});setBeingEdit(c.comment);},style:{float:'right'},children:\"Edit\"}),c.author===props.username&&/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",onClick:function onClick(e){return handleDeleteComment(props.post.id,c.author,c.comment);},style:{float:'right'},children:\"Delete\"}),editShow&&c.author===props.username&&c.comment==beingEdit&&/*#__PURE__*/_jsxs(Form,{onSubmit:function onSubmit(e){return handleUpdateComment(e,props.post.id,c.author,c.comment,editInput,mentionInput);},children:[/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",controlId:\"formBasicDescription\",children:/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",onChange:function onChange(e){return setEditInput(e.target.value);},placeholder:\"Edit your comment.\",rows:2,value:editInput})}),/*#__PURE__*/_jsx(MentionsInput,{value:mentionInput,onChange:function onChange(e){return setMentionInput(e.target.value);},placeholder:\"Mention people using '@'\",children:/*#__PURE__*/_jsx(Mention,{trigger:\"@\",data:function data(search){return[{id:search,display:search}];}})}),/*#__PURE__*/_jsx(Row,{style:{paddingBottom:'1rem'}}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Done\"})]})]})})]})})});});return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Modal,_objectSpread(_objectSpread({},props),{},{size:\"xl\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{id:\"contained-modal-title-vcenter\",children:\"Comments\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsx(Stack,{gap:3,children:commentsList})}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{onClick:props.onHide,children:\"Close\"})})]}))});}","map":{"version":3,"names":["React","useState","addComment","deletePost","deleteComment","updateComment","Row","Col","Modal","Stack","NavLink","Form","Button","MentionsInput","Mention","MyCommentsModal","props","comments","post","editShow","setEditShow","editInput","setEditInput","beingEdit","setBeingEdit","mentionInput","setMentionInput","handleUpdateComment","e","postId","author","oldComment","newComment","mention","preventDefault","setEditedAndRefreshCards","oldEditedAndRefreshCards","alert","current","onHide","console","log","handleDeleteComment","content","res","commentsList","length","map","c","comment","replace","split","username","float","id","target","value","search","display","paddingBottom"],"sources":["/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/src/components/MyCommentsModal.js"],"sourcesContent":["import \"../Styles.css\";\nimport React, { useState } from 'react';\nimport { addComment, deletePost, deleteComment, updateComment} from \"../fetcher\";\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Modal from 'react-bootstrap/Modal';\nimport Stack from 'react-bootstrap/Stack';\nimport { NavLink } from \"react-router-dom\";\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport { MentionsInput, Mention } from 'react-mentions'\n\nexport function MyCommentsModal(props) {\n    const comments = props.post.comments;\n    const [editShow, setEditShow] = useState(false);\n    const [editInput, setEditInput] = useState(\"\");\n    const [beingEdit, setBeingEdit] = useState(\"\");\n    const [mentionInput, setMentionInput] = useState(\"\");\n\n    async function handleUpdateComment(e, postId, author, oldComment, newComment, mention){\n        e.preventDefault();\n        try{\n            await updateComment(postId, author, oldComment, newComment, mention);\n            // tell my grandparent to refresh the page \n            props.setEditedAndRefreshCards(!props.oldEditedAndRefreshCards);\n            alert(\"update comment successful!\");\n\n          //setEditedAndRefreshCards to trigger rerender and data fetching\n          props.setEditedAndRefreshCards(!props.oldEditedAndRefreshCards);\n          //setShow(false);\n          setEditShow(current => !current);\n          props.onHide();\n        }catch(err){\n            console.log(\"update comment failed.\");\n            alert(\"update comment failed.\");\n        }\n        \n    };\n\n    async function handleDeleteComment(postId, author, content){\n      try{\n          console.log(`'${postId}', '${author}', '${content}'`);\n          let res = await deleteComment(postId,author,content);\n          console.log(\"response: \", res);\n           // tell my grandparent to refresh the page \n          props.setEditedAndRefreshCards(!props.oldEditedAndRefreshCards);\n          alert(\"Delete comment successful!\");\n      }catch(err){\n          console.log(\"Delete comment failed.\");\n          alert(\"Delete comment failed.\");\n      }\n  };\n  \n    const commentsList = comments.length === 0 ? []: comments.map((c)=>{\n      return (\n        <>\n          <div className=\"bg-light border\">\n            <Row>\n              <Col><h4>{c.author}</h4></Col>\n              <Col >\n                <p>{c.comment + \" \"} \n                  <NavLink to={\"/user/\"+c.mention.replace(')', '').split(\"(\")[1]} className=\"button_text\">\n                    {c.mention.split(\"(\")[0]}\n                  </NavLink>\n  \n                  {c.author === props.username && (\n                  <Button onClick={(e) => {setEditShow(current => !current);setBeingEdit(c.comment)}} style={{float: 'right'}} >Edit</Button>\n                  )}\n  \n                  {c.author === props.username && (\n                  <Button variant=\"outline-danger\" onClick={(e) => handleDeleteComment(props.post.id, c.author, c.comment)} style={{float: 'right'}} >Delete</Button>\n                  )}\n  \n                  {editShow && c.author === props.username && c.comment == beingEdit && (\n                  <Form onSubmit={(e) => handleUpdateComment(e, props.post.id, c.author, c.comment, editInput, mentionInput)}>\n                      <Form.Group className=\"mb-3\" controlId=\"formBasicDescription\">\n                      <Form.Control as=\"textarea\" onChange={e => setEditInput(e.target.value)}\n                        placeholder=\"Edit your comment.\" \n                        rows={2}\n                        value={editInput}/>\n                      </Form.Group>\n                      <MentionsInput value={mentionInput} onChange={e => setMentionInput(e.target.value)} placeholder={\"Mention people using '@'\"}>\n                        <Mention\n                          trigger=\"@\"\n                          data={(search) => [{ id: search, display: search }]}\n                        />\n                      </MentionsInput>\n                      <Row style={{paddingBottom:'1rem'}}></Row>\n                      <Button variant=\"primary\" type=\"submit\">\n                        Done\n                      </Button>\n                  </Form>\n                  )}\n                  \n                </p>\n              </Col>\n            </Row>\n              </div>\n        </>\n      )\n    }) ;\n  \n    return (\n      <>\n      <Modal\n        {...props}\n        size=\"xl\"\n        aria-labelledby=\"contained-modal-title-vcenter\"\n        centered\n      >\n        <Modal.Header closeButton>\n          <Modal.Title id=\"contained-modal-title-vcenter\">\n            Comments\n          </Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n            <Stack gap={3}>\n                {commentsList}\n            </Stack>\n          \n        </Modal.Body>\n        <Modal.Footer>\n          <Button onClick={props.onHide}>Close</Button>\n        </Modal.Footer>\n      </Modal>\n  \n      </>\n  \n    );\n  }\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}