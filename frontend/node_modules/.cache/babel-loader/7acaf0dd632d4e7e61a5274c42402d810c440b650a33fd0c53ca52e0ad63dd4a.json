{"ast":null,"code":"import _regeneratorRuntime from\"/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{Footer}from\"../components/Footer\";import Button from'react-bootstrap/Button';import Form from'react-bootstrap/Form';import Container from'react-bootstrap/Container';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import{getUser}from\"../fetcher\";import{useState}from'react';import{Navigate}from\"react-router-dom\";import{useSelector,useDispatch}from'react-redux';import{updateCurrentUser,selectCurrentUser}from'./UserPage/currentUserSlice';//the compoent of a LoginForm which keep track of login username\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LoginForm(props){// local state\nvar stateCurrentUser=useSelector(selectCurrentUser);var dispatch=useDispatch();var _useState=useState({username:'',password:''}),_useState2=_slicedToArray(_useState,2),newInput=_useState2[0],setInput=_useState2[1];var handleOnChange=function handleOnChange(e){if(e.target.name===\"username\"){setInput(function(state){return{username:e.target.value,password:state.password};});}if(e.target.name==='password'){setInput(function(state){return{username:state.username,password:e.target.value};});}};//here login means fetch the user by username from the mock api\nvar handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();// send GET request to fetch the Student by username\nconsole.log(\"input username\",newInput.username);_context.next=4;return getUser(newInput.username);case 4:user=_context.sent;if(user===undefined){//login failed, due to wrong username cannot fetch data\nalert(\"Login failed due to unknown username!\\n Please try one of these: tiger/trump/pig/dog/curry/ayesha/obama\");}else{if(user.password===newInput.password){//login success!\n// then update state\n// store.dispatch(loginAs(student)); // dispatch action add student to store\nconsole.log(\"before dispatch: \".concat(stateCurrentUser.username));dispatch(updateCurrentUser(user));alert(\"Login Success! logged in as: \\n\\n\"+JSON.stringify(user));props.updateAuthen(true);}else{alert(\"password incorrect!\");}}case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Form,{id:\"submitForm\",onSubmit:handleLogin,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formBasicEmail\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Username\"}),/*#__PURE__*/_jsx(Form.Control,{name:\"username\",onChange:handleOnChange,placeholder:\"Enter username (eg. dog)\"})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"formBasicPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{name:\"password\",type:\"password\",onChange:handleOnChange,placeholder:\"Password\"})]}),/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",controlId:\"formBasicCheckbox\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Login\"})]});}//the largest scope state controling the routing \nfunction LoginPage(){var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),authenticated=_useState4[0],setAuthen=_useState4[1];if(!authenticated){return/*#__PURE__*/_jsxs(\"div\",{className:\"background\",children:[/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Row,{md:true,children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"label\",{})})}),/*#__PURE__*/_jsxs(Row,{md:true,children:[/*#__PURE__*/_jsx(Col,{}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(LoginForm,{updateAuthen:setAuthen})}),/*#__PURE__*/_jsx(Col,{})]}),/*#__PURE__*/_jsx(Row,{ms:true})]}),/*#__PURE__*/_jsx(\"div\",{style:{paddingLeft:\"2rem\",paddingTop:\"5rem\"},children:/*#__PURE__*/_jsx(Footer,{})})]});}else{return/*#__PURE__*/_jsx(Navigate,{replace:true,to:'/feed'});}}export default LoginPage;","map":{"version":3,"names":["React","Footer","Button","Form","Container","Row","Col","getUser","useState","Navigate","useSelector","useDispatch","updateCurrentUser","selectCurrentUser","LoginForm","props","stateCurrentUser","dispatch","username","password","newInput","setInput","handleOnChange","e","target","name","state","value","handleLogin","preventDefault","console","log","user","undefined","alert","JSON","stringify","updateAuthen","LoginPage","authenticated","setAuthen","paddingLeft","paddingTop"],"sources":["/Users/zanemaomac/Desktop/CIS5570/project/project---design-hw1-team_offersoverflow/WEB_APP/frontend/src/pages/LoginPage.js"],"sourcesContent":["import React from 'react';\nimport { Footer } from \"../components/Footer\";\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport { getUser } from \"../fetcher\";\nimport { useState } from 'react';\nimport { Navigate } from \"react-router-dom\";\nimport { useSelector, useDispatch} from 'react-redux'\nimport {updateCurrentUser, selectCurrentUser} from './UserPage/currentUserSlice'\n\n\n//the compoent of a LoginForm which keep track of login username\nfunction LoginForm(props){\n  // local state\n  const stateCurrentUser = useSelector(selectCurrentUser);\n  const dispatch = useDispatch();\n\n  const [newInput, setInput] = useState({ username: '', password: '' });\n\n  const handleOnChange = (e) => {\n    if (e.target.name === \"username\") {\n      setInput((state) => ({\n        username: e.target.value,\n        password: state.password,\n      }));\n    }\n    if (e.target.name === 'password') {\n      setInput((state) => ({\n        username: state.username,\n        password: e.target.value,\n      }));\n    }\n  };\n\n  //here login means fetch the user by username from the mock api\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    // send GET request to fetch the Student by username\n    console.log(\"input username\", newInput.username);\n    let user = await getUser(newInput.username);\n\n    if(user === undefined){\n      //login failed, due to wrong username cannot fetch data\n      alert(\"Login failed due to unknown username!\\n Please try one of these: tiger/trump/pig/dog/curry/ayesha/obama\")\n    }else{\n        if(user.password===newInput.password){\n        //login success!\n        // then update state\n        // store.dispatch(loginAs(student)); // dispatch action add student to store\n        console.log(`before dispatch: ${stateCurrentUser.username}`);\n        dispatch(updateCurrentUser(user));\n\n        alert(\"Login Success! logged in as: \\n\\n\" + JSON.stringify(user)); \n        props.updateAuthen(true);\n        }else{\n          alert(\"password incorrect!\")\n        }\n        \n    }\n    \n  };\n\n\n  return(\n  <Form id=\"submitForm\" onSubmit={handleLogin}>\n    <Form.Group className=\"mb-3\" controlId=\"formBasicEmail\">\n      <Form.Label>Username</Form.Label>\n      <Form.Control name=\"username\" onChange={handleOnChange} placeholder=\"Enter username (eg. dog)\" />\n    </Form.Group>\n\n    <Form.Group className=\"mb-3\" controlId=\"formBasicPassword\">\n      <Form.Label>Password</Form.Label>\n      <Form.Control name=\"password\" type=\"password\" onChange={handleOnChange} placeholder=\"Password\" />\n    </Form.Group>\n    <Form.Group className=\"mb-3\" controlId=\"formBasicCheckbox\">\n      {/* <Form.Check type=\"checkbox\" label=\"Remain login next time\" /> */}\n    </Form.Group>\n    <Button variant=\"primary\" type=\"submit\">\n      Login\n    </Button>\n  </Form>\n  );\n}\n\n//the largest scope state controling the routing \n\n\nfunction LoginPage() {\n  const [authenticated, setAuthen] = useState(false);\n\n  if(!authenticated){\n    return (\n      <div className=\"background\">\n      <Container>\n        <Row md>\n      \n          <Col><label></label></Col>\n        </Row>\n        <Row md>\n          <Col></Col>\n          <Col><LoginForm updateAuthen= {setAuthen}/></Col>\n          <Col></Col>\n        </Row>\n        <Row ms>\n        </Row>\n      </Container>\n      <div style={{paddingLeft: \"2rem\", paddingTop: \"5rem\"}}>\n        <Footer />\n        </div>\n      </div>\n    )\n  }else{\n    return <Navigate replace to={'/feed'} />;\n  }\n    \n}\nexport default LoginPage"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}